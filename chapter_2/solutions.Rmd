---
title: "Solutions Week 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Suppose the globe tossing data had turned out to be 8 water in 15 tosses.
Construct the posterior distribution, using grid approximation. Use the
same flat prior as before.

```{r}
tosses <- 15
w <- 8

num_pts <- 100
p_grid <- seq(0, 1, length.out = num_pts)
flat_prior <- rep(1, num_pts)
lkhd <- dbinom( w, tosses, prob=p_grid)

post <- flat_prior * lkhd
posterior <- post / sum(post)
```

```{r}
plot(p_grid, posterior, main="Posterior", type="b", xlab="Probability of Water", ylab="Posterior")
```


2. Start over in 1, but now use a prior that is zero below p = 0.5 and a con-
stant above p = 0.5. This corresponds to prior information that a majority
of the Earth’s surface is water. What difference does the better prior make?
If it helps, compare posterior distributions (using both priors) to the true
value p = 0.7.

```{r}
better_prior <- ifelse(p_grid < 0.5, 0, 1)
new_post <- better_prior * lkhd
new_posterior <- new_post / sum(new_post)

plot(p_grid, new_posterior, main="Posterior with Step Prior", type="b", xlab="Probability of Water", ylab="Posterior")

```

```{r}
size <- 1000
post_sample <- sample(p_grid, size, replace = TRUE, prob = posterior)
mean(post_sample >= 0.6)
```


```{r}
new_post_sample <- sample(p_grid, size, replace = TRUE, prob = new_posterior)
mean(new_post_sample >= 0.6)
```

```{r}
library(rethinking)
dens( post_sample)
abline(v=0.7)
```

```{r}
dens( new_post_sample , xlim=c(0,1))
abline(v=0.7)
```

3. This problem is more open-ended than the others. Feel free to collabo-
rate on the solution. Suppose you want to estimate the Earth’s proportion of
water very precisely. Specifically, you want the 99% percentile interval of the
posterior distribution of p to be only 0.05 wide. This means the distance be-
tween the upper and lower bound of the interval should be 0.05. How many
times will you have to toss the globe to do this? I won’t require a precise
answer. I’m honestly more interested in your approach.


